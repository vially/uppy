{"version":3,"sources":["../../../src/plugins/Dashboard/FileItem.js"],"names":["require","getFileNameAndExtension","truncateString","copyToClipboard","prettyBytes","FileItemProgress","getFileTypeIcon","FilePreview","iconEdit","iconCopy","iconRetry","classNames","h","module","exports","fileItem","props","file","acquirers","isProcessing","progress","preprocess","postprocess","isUploaded","uploadComplete","error","uploadInProgressOrComplete","uploadStarted","uploadInProgress","isPaused","fileName","meta","name","truncatedFileName","isWide","onPauseResumeCancelRetry","ev","retryUpload","id","resumableUploads","pauseUpload","cancelUpload","dashboardItemClass","progressIndicatorTitle","i18n","backgroundColor","type","color","showLinkToFileUploadResult","uploadURL","percentage","fileID","extension","data","size","source","map","acquirer","icon","metaFields","length","e","toggleFileCard","then","log","info","catch","removeFile"],"mappings":"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","file":"FileItem.js","sourcesContent":["const { getFileNameAndExtension,\n         truncateString,\n         copyToClipboard } = require('../../core/Utils')\nconst prettyBytes = require('prettier-bytes')\nconst FileItemProgress = require('./FileItemProgress')\nconst getFileTypeIcon = require('./getFileTypeIcon')\nconst FilePreview = require('./FilePreview')\nconst { iconEdit, iconCopy, iconRetry } = require('./icons')\nconst classNames = require('classnames')\nconst { h } = require('preact')\n\nmodule.exports = function fileItem (props) {\n  const file = props.file\n  const acquirers = props.acquirers\n\n  const isProcessing = file.progress.preprocess || file.progress.postprocess\n  const isUploaded = file.progress.uploadComplete && !isProcessing && !file.error\n  const uploadInProgressOrComplete = file.progress.uploadStarted || isProcessing\n  const uploadInProgress = (file.progress.uploadStarted && !file.progress.uploadComplete) || isProcessing\n  const isPaused = file.isPaused || false\n  const error = file.error || false\n\n  const fileName = getFileNameAndExtension(file.meta.name).name\n  const truncatedFileName = props.isWide ? truncateString(fileName, 14) : fileName\n\n  const onPauseResumeCancelRetry = (ev) => {\n    if (isUploaded) return\n    if (error) {\n      props.retryUpload(file.id)\n      return\n    }\n    if (props.resumableUploads) {\n      props.pauseUpload(file.id)\n    } else {\n      props.cancelUpload(file.id)\n    }\n  }\n\n  const dashboardItemClass = classNames(\n    'uppy-DashboardItem',\n    { 'is-inprogress': uploadInProgress },\n    { 'is-processing': isProcessing },\n    { 'is-complete': isUploaded },\n    { 'is-paused': isPaused },\n    { 'is-error': error },\n    { 'is-resumable': props.resumableUploads }\n  )\n\n  const progressIndicatorTitle = isUploaded\n    ? props.i18n('uploadComplete')\n    : props.resumableUploads\n      ? file.isPaused\n        ? props.i18n('resumeUpload')\n        : props.i18n('pauseUpload')\n      : error\n        ? props.i18n('retryUpload')\n        : props.i18n('cancelUpload')\n\n  return <li class={dashboardItemClass} id={`uppy_${file.id}`} title={file.meta.name}>\n    <div class=\"uppy-DashboardItem-preview\">\n      <div class=\"uppy-DashboardItem-previewInnerWrap\" style={{ backgroundColor: getFileTypeIcon(file.type).color }}>\n        {props.showLinkToFileUploadResult && file.uploadURL\n          ? <a class=\"uppy-DashboardItem-previewLink\" href={file.uploadURL} rel=\"noreferrer noopener\" target=\"_blank\" />\n          : null\n        }\n        <FilePreview file={file} />\n      </div>\n      <div class=\"uppy-DashboardItem-progress\">\n        {isUploaded\n          ? <div class=\"uppy-DashboardItem-progressIndicator\">\n            {FileItemProgress({\n              progress: file.progress.percentage,\n              fileID: file.id\n            })}\n          </div>\n          : <button class=\"uppy-DashboardItem-progressIndicator\"\n            type=\"button\"\n            aria-label={progressIndicatorTitle}\n            title={progressIndicatorTitle}\n            onclick={onPauseResumeCancelRetry}>\n            {error\n              ? iconRetry()\n              : FileItemProgress({\n                progress: file.progress.percentage,\n                fileID: file.id\n              })\n            }\n          </button>\n        }\n      </div>\n    </div>\n    <div class=\"uppy-DashboardItem-info\">\n      <h4 class=\"uppy-DashboardItem-name\" title={fileName}>\n        {props.showLinkToFileUploadResult && file.uploadURL\n          ? <a href={file.uploadURL} rel=\"noreferrer noopener\" target=\"_blank\">\n            {file.extension ? truncatedFileName + '.' + file.extension : truncatedFileName}\n          </a>\n          : file.extension ? truncatedFileName + '.' + file.extension : truncatedFileName\n        }\n      </h4>\n      <div class=\"uppy-DashboardItem-status\">\n        {file.data.size ? <div class=\"uppy-DashboardItem-statusSize\">{prettyBytes(file.data.size)}</div> : null}\n        {file.source && <div class=\"uppy-DashboardItem-sourceIcon\">\n            {acquirers.map(acquirer => {\n              if (acquirer.id === file.source) {\n                return <span title={`${props.i18n('fileSource')}: ${acquirer.name}`}>\n                  {acquirer.icon()}\n                </span>\n              }\n            })}\n          </div>\n        }\n      </div>\n      {(!uploadInProgressOrComplete && props.metaFields && props.metaFields.length)\n        ? <button class=\"uppy-DashboardItem-edit\"\n          type=\"button\"\n          aria-label={props.i18n('editFile')}\n          title={props.i18n('editFile')}\n          onclick={(e) => props.toggleFileCard(file.id)}>\n          {iconEdit()}\n        </button>\n        : null\n      }\n      {props.showLinkToFileUploadResult && file.uploadURL\n        ? <button class=\"uppy-DashboardItem-copyLink\"\n          type=\"button\"\n          aria-label={props.i18n('copyLink')}\n          title={props.i18n('copyLink')}\n          onclick={() => {\n            copyToClipboard(file.uploadURL, props.i18n('copyLinkToClipboardFallback'))\n              .then(() => {\n                props.log('Link copied to clipboard.')\n                props.info(props.i18n('copyLinkToClipboardSuccess'), 'info', 3000)\n              })\n              .catch(props.log)\n          }}>{iconCopy()}</button>\n        : ''\n      }\n    </div>\n    <div class=\"uppy-DashboardItem-action\">\n      {!isUploaded &&\n        <button class=\"uppy-DashboardItem-remove\"\n          type=\"button\"\n          aria-label={props.i18n('removeFile')}\n          title={props.i18n('removeFile')}\n          onclick={() => props.removeFile(file.id)}>\n          <svg aria-hidden=\"true\" class=\"UppyIcon\" width=\"60\" height=\"60\" viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path stroke=\"#FFF\" stroke-width=\"1\" fill-rule=\"nonzero\" vector-effect=\"non-scaling-stroke\" d=\"M30 1C14 1 1 14 1 30s13 29 29 29 29-13 29-29S46 1 30 1z\" />\n            <path fill=\"#FFF\" vector-effect=\"non-scaling-stroke\" d=\"M42 39.667L39.667 42 30 32.333 20.333 42 18 39.667 27.667 30 18 20.333 20.333 18 30 27.667 39.667 18 42 20.333 32.333 30z\" />\n          </svg>\n        </button>\n      }\n    </div>\n  </li>\n}\n"]}